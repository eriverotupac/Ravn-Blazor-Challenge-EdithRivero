@page "/"

@inject PeopleService PeopleService

<div class="row">
    <div class="panelPeopleList">
        @if (manyPeople == null)
        {
            <span style="position:absolute center">Loading... </span>
        }
        else
        {
            <ul>
                @foreach (var people in manyPeople)
                {
                    <li class="personCell">
                        <div class="row">
                            <div class="col-sm-10">
                                <span class="textPersonBold">
                                    @people.Name
                                    <br />
                                    <span class="textPersonShadow">
                                        @string.Concat(@people.Gender, " from ", @people.Planet)
                                    </span>
                                </span>
                            </div>
                            <div class="col-sm-2">
                                <span class="oi oi-chevron-right textPersonIcon" @onclick="(()=>ShowDetails(people.Name))"></span>
                            </div>
                        </div>
                    </li>

                }
            </ul>
        }
    </div>

    @if (requestDetails)
    {
        <div class="col-sm-12 panelPeopleInfo">
            <div class="parentCellHeader">
                <span class="parentCellHeaderText">General Information</span>
            </div>
            <div class="col-sm-12 infoCell">
                <span class="infoCellTextLabel"> Eye Color</span>
                <span class="infoCellTextValue">@requestedPeople.Eye</span>
            </div>
            <div class="col-sm-12 infoCell">
                <span class="infoCellTextLabel"> Hair Color</span>
                <span class="infoCellTextValue">@requestedPeople.Hair</span>
            </div>
            <div class="col-sm-12 infoCell">
                <span class="infoCellTextLabel"> Skin Color</span>
                <span class="infoCellTextValue">@requestedPeople.Skin</span>
            </div>
            <div class="col-sm-12 infoCell">
                <span class="infoCellTextLabel">Birth Year</span>
                <span class="infoCellTextValue">@requestedPeople.Birth</span>
            </div>

            <div class="parentCellHeader">
                <span class="parentCellHeaderText">Vehicles</span>
            </div>
            @foreach (var vehicleName in requestedPeople.Vehicles)
            {
                <div class=" col-sm-12 infoCell">
                    <span class="infoCellTextLabel">@vehicleName </span>
                </div>
            }
        </div>
    }
    else
    { @string.Empty}
</div>
@code {
    private IEnumerable<People> manyPeople;
    private bool requestDetails = false;
    private People requestedPeople = new People() { Eye = "Pepito", Hair = "Blue", Skin = "y", Birth = "ooo", Vehicles = new string[2] { "d", "y" } };

    protected override async Task OnInitializedAsync()
    {
        manyPeople = await PeopleService.GetPeople();
    }

    private void ShowDetails(string name)
    {
        requestDetails = !requestDetails;
        var found = (People)manyPeople.FirstOrDefault(x => x.Name == name);
        requestedPeople = found;
    }
}
